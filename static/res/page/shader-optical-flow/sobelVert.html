<!DOCTYPE HTML>
<html>
 <head>
  <title>Sobel Test</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1">
  <link rel="icon" type="image/png" href="favicon.png"/>
  <script type="text/javascript" src="./node_modules/glslCanvas/build/GlslCanvas.js"></script>
 </head>
 <body style="margin:0;padding:0;overflow:hidden;">
   <script id="vertexShader" type="x-shader/x-vertex">
    attribute vec4 a_position;
    void main(){
      gl_Position = a_position;
    }
   </script>
   <script id="fragmentShader" type="x-shader/x-fragment">
     #ifdef GL_ES
     precision mediump float;
     #endif
     uniform vec2 u_mouse;
     uniform vec2 u_resolution;
     uniform sampler2D u_texture1;

      void main(void) {
        vec2 vUv = gl_FragCoord.xy / u_resolution.xy;
        float x = 1.0 / u_resolution.x;
        float y = 1.0 / u_resolution.y;
        vec4 horizEdge = vec4( 0.0 );
        horizEdge -= texture2D( u_texture1, vec2( vUv.x - x, vUv.y - y ) ) * 1.0;
        horizEdge -= texture2D( u_texture1, vec2( vUv.x - x, vUv.y     ) ) * 2.0;
        horizEdge -= texture2D( u_texture1, vec2( vUv.x - x, vUv.y + y ) ) * 1.0;
        horizEdge += texture2D( u_texture1, vec2( vUv.x + x, vUv.y - y ) ) * 1.0;
        horizEdge += texture2D( u_texture1, vec2( vUv.x + x, vUv.y     ) ) * 2.0;
        horizEdge += texture2D( u_texture1, vec2( vUv.x + x, vUv.y + y ) ) * 1.0;

        vec4 vertEdge = vec4( 0.0 );
        vertEdge -= texture2D( u_texture1, vec2( vUv.x - x, vUv.y - y ) ) * 1.0;
        vertEdge -= texture2D( u_texture1, vec2( vUv.x    , vUv.y - y ) ) * 2.0;
        vertEdge -= texture2D( u_texture1, vec2( vUv.x + x, vUv.y - y ) ) * 1.0;
        vertEdge += texture2D( u_texture1, vec2( vUv.x - x, vUv.y + y ) ) * 1.0;
        vertEdge += texture2D( u_texture1, vec2( vUv.x    , vUv.y + y ) ) * 2.0;
        vertEdge += texture2D( u_texture1, vec2( vUv.x + x, vUv.y + y ) ) * 1.0;

        vec3 edge = sqrt((horizEdge.rgb * horizEdge.rgb) + (vertEdge.rgb * vertEdge.rgb));

        gl_FragColor = vec4(vertEdge.xyz * 0.125 + 0.5, 1);//vec4( edge, texture2D( u_texture1, vUv ).a );
      }

   </script>
   <canvas id="glslCanvas" width="1270" height="1614"></canvas>
   <script>
    var canvas = document.getElementById("glslCanvas");
    canvas.style.height = "100%";
    //canvas.style.width = "100%";
    var sandbox = new GlslCanvas(canvas);

    var fragShader=document.getElementById('fragmentShader').innerHTML;
    var vertShader=document.getElementById('vertexShader').innerHTML;
    sandbox.setUniform("u_texture1","data/verportal_0615.png");

    sandbox.load(fragShader);

   </script>

 </body>
</html>
